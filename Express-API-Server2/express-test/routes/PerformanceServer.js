const express = require('express');
const Web3 = require('web3');
const router = express.Router();

// Ethereum 노드 URL
// server 1
// const ethereumNodeUrl = 'http://43.200.240.107:8545';

// server 2
const ethereumNodeUrl = 'http://54.180.210.12:8702';
const privateKey = ['0x32291002cb5f1ecacc045a05610909c876e6365e3c256b8a0de73667519aaf1d','0x05df5f7417425f7cc152194a20a51c9ac0ef15eb577241ddb9257b79b066ecec','0x7177757fac8ec8db95869f4816c7c0395aaf0bd4a65e2258e7c325dcaa6134ef','0xd8af4947ccf1c3429ad80b69af4c09d3560d2a520eca7f4fc3a90c40f796fb84','0xf2b3e5ec068e3e0594a30b4a3fa6932877f10ad7fb8a401343a56de55cf88da6','0xf863dbcf025a5f271bac6129f817d1bf83e7c8206901ac5fb5f4ec4f69b2d806','0x8c34aa731ac8bf1a1edb76e8df06ac1f2d8ddd4a093d48efb6de02157378c5c6','0xd6979b92da50a27ccf442f743f66ea21c41961433e1d153bf7c631919e0f3bbc','0xfccd73602899f186db569c9b8c2b4017e659f4870139e49ea82a9fc732969c6f','0x293fa751487ea6fa27aa718063a43c489eb3f8f2260049782216bc0d8ac7502e','0xa28abde44525510507a27c46117c86541b01a2c237873c54ceea185821ee2e2e','0xff8d8c8bead8af3736f1dec3fb1f595a8588f6da42367b2fac79b8b2ef6a452f','0xd392bbf6122dfb25eb4bc632c78fca0e2e1b8d2bdfef1d5d328adcc2de1da80b','0x646f9057415b9e824050c705232f9c99d800397fd79bb52c43fb0a30b0839197','0x55a71479f0e29f297ce8d0d21dd92d84f1e0b708e053c1dee724d08771201a91','0x42ec7b16684d04c9b4f827f640ff29444a661994fcb788eedce7edfafc6d0339','0x64687296fdc79ef0076632a2306d58dcc8eb8b34c70701c83cf9cdd18b6b3fcd','0xa0634f19705ca46b9601feb76593bd826afa1c481cefc84951ee89aebe5db8a8','0x9350f7dd520339a919c63f0affb0ac92ba502d8af6269b9d9a3ff00d79464a1d','0x2c6af402bfd27e839bb3e6fbb20197a38aa0df7928a3384a9e15db34c01f6fe0','0xd25e5d45afd22348d9f0af73e0893c04a9335dc176d4dfd86a572385e4fac6e3','0x2bb753cb31f53daa3e3d78fe3a6e560ad87b46491e702c127c5602d521ab64b3','0x47e857746d88eb0e2187f41edaf05fa5535d449c1ee08d0f40525658ea8f96fd','0xc76c36cf970a61610d5b35d26b9a30785addc25d25ba3ce115bc361634d5e56b','0xd5b4f5d35a15b90fbd9d3748172b9f2dcb53f864a03e5a65ebd4ac0b9579d8ad','0xd4a684a3a61ece1ded9f002a1a1b5d9e3e27d146326e77d5d20a8edbef4d0ed6','0x192ef76dacaedf0150ccaafc7bd0af07014434cb7ca01993c482c103c704087b','0x85abe7e76373b50e8ade0f68530eff595e71c8eefdec0912ae7d23f686fd0e6e','0x8430e693a8f44cd44f34fb8354f1b97b61be0780e45259390b9816af3fe58150','0xdffe7782439ad11ec93297e2c3feca91c9b5cb6de60fa2a460fc573fe98b0ef1','0x1980a77478b754cdf56c337b8445dfc1bde8f310a33868023bdb42328d434aa4','0x1963e263533b66a2a6851ac2433a1c4843db1c9fa51a7fc5f9928e0854b4d314','0x165411e26ef44602c1456c2ce35696c734b2635ec8574a3675b824192006bd1a','0x1ba354a780c2617a06327b5b4b59dc6a90b5e63477b548815a1c610b72826067','0x507c8170c358d443f6a4e5f4d84b78f874126d3a8b2a3d4ad39c28004a16cd11','0x9d43a002f62b0bc8c1dca29e8d3607088d6138ab1fc3e8e47d38ca7ac97b095d','0xa1dd83aaf9df52460c1f29fb0f72bbc91e8314bfd98015d023ec3068c453562e','0x78937da06c6991be132fc0b598ead1f023c6e33d4ec0b80b5504ba6e05cc8ac1','0xdd60450cc09dd1ad9f55a499d28d159e9c97c9b78ca89f45c02380dbd1a2780c','0x27a3076b9fcbb8378849b4a48c7129b1b25409f83751ae20767e44bf4c94c883','0x7e3b63cd5cbce7c97dd48d0a49c0a391b45bf96484b937182a43e98d88950882','0xa65b48901b9130a33cbf83945d849e291dfe1f7a500351c3ddf4ca21d443468f','0xfb186edcf44e33252ff204ec3fbf79e8b9da09f7bedfc98532d90f2d42264a1e','0x2cafe418fd9a64bd639599adfa951d75d66c72ed1340afcfc54d460c8f9eeec6','0x4c5aadab912fc9e16383df12a8ff6913cac31970fb0967f0b09b1c568ee07f70','0x6cae9d68c662f3b529ba469deffcbf867b461a130ed90c5d74f39360e1e83c23','0xcb19569fe6f905665d551b18f6c66240eabce86e02d9694001030cb1bbbbf47e','0x3a2e411b35857ab9c4d71c7f702aea6d19d89a5114c78cfe54908713af654c72','0xc1a50a08c4e6643aceda9ecab915577f443e5e5a41ca4a6fa7a2e3c56255c60e','0x386c37f99535eac9a8cdf2c1b0db2c5e09afd571881edcdc3d7d6d953e1314fa','0x5bf014bd26480ad1486bfd7731d0a05d3c04a740a2b068a3e94493705cb1d030','0xd3aee0313694e133715a9da2a19d4284459102f6d8a3d761269a10a4366a4486','0x26dc81b49eb5bf84db85bbaef5f58276d2bedf93cf92d224aa287a260d8a0340','0x75825d8f2c41b2ee3b0fc35184accdb11e8d47f64711a212222e48c331220e0e','0x565fb6420996688c8ed8e16815a8856acfabb7190b51c7d4a856fb4f3893e19c','0xa34f170be2fa88802bfe6214e4411cd7e960e6233196bf31d89aa25b36546e8a','0x10165ff781db549133e962c873545e1ae73c7ec2c89b62a95386851915ae9c57','0xe6b1b169115868616a782723de629128057fc698e648cf518da7d61c38d4af00','0x6450bb74a1ab1caa6f0cc31b575adb4d01628a72513e19a9345a372e5cfe5c3f','0x1d28b4bd6ffeec537017312a4cbfdbfdbf232208dafa389ad755c9988ec4d428','0x18543784ca82509bfd50b34cdf0b7254681ac7cb048c46fb650150dbb30cdc4e','0x24449400301012f78b92f992f1f1b7205cc19761c4fde3f6fa983d8b60e45b72','0x4b49e9169e804c5d0ee136a83f388f70225265a3f5524b81749a50672ccf0111','0xa22a6742521e780367a8b7817a6d234d6f938ebe430b27bbb53e102e2ee7a745','0x5b014e9a9e73366d508b97dce83b8c913c711be616774ed360fa03c8d97bfc13','0x0ccef6fce63f818ce7ddd41ee61546e549227032ada5bbccb2c974d596615120','0xf92ede2ca706aec4603e970bebddf9b048021ed18ea29bb7287ab4d3d07f1a0f','0x97c7dfdbe677ba946da59e790286fc4003070563d62c241dc79470f13117db6f','0x28d35c74f7b42345b1ea14e6651bd50b7fc589d56d2fe1ede823175521dcb445','0xb4381517dcb72a92186e6d3088208e6cd3ef9e447d32a11a36747eaccc593ce2','0x8787830b0e3c39ccd788b6023889c890bb52c8e4b08aca576d9e6d6e482f902c','0x2d9f8e59595ab01607a1b488cab2d386bfdeb49b8be55c3b9ad0c4bb4c7bb8af','0x61c6654301f9dd1fb37e73b2a9d35b55deb136e0e78a0ab6df7b458a46944dc9','0xbd16d05c8e10d12bf0656d716d6f1653b3667f1043992f3b0b7f68d2fa02a17e','0x558c00fe48e81fe9739d347741c926a446b4edafd1c6ceefef73137168cc7cb5','0x8df7d61db9881c7eb82e0139c3c521b9757e001cb431d7d505bd000bfc71f7f9','0x453220b6d226e49ed231d2ef689ccfa2d9b667e6e3c62a2f76eeef709519a283','0xb19940edf58541781c1f37096472a33d6a4ba6f3a9203579b2cdb15dc54f3663','0x6297e7f89483c5de8229369dc731530866c37908a0dfde9a62b3c5ad73d0556e','0x95d96241030d9df814c5499066b30c6e4c7dbd28258bd5995338a5bff3dff286','0x287e241323abeb181826dda8ded17cf823421b1ff6543279fa5e1314f347d2ed','0x4b405eaec997f1016d96067e032a9d6d3342b50449a1f67b428d744fcdb71a96','0x4b46677f570cf4aac1942a1340eb94df1f15b0482b60f07b0d9475500c35588a','0xfa867d1709ad711030a6c6321cfff4558909c6788c33d23770904164985a2238','0x778d4a6b34d5ae194027f60770ce2456be6db3d1318a30a39913a6817d3d6189','0x4c34b147080498cd30a1228ac72e7a1f3d59c9e9e8008fbb5a5ba6f3ab258024','0x2aa3eff42de7f92f5a426d7db118ef7e9e95ca13adbd2eb85f60916e87cc2b6f','0x9fac38882db64b633084e422759dd4c4730058b0ac029e4f743d8f0bb891736c','0x30e8036dd97b8e53ac35df72c62ddf5d84140f175504568657ab19bac46984b0','0xaa4d6187e3f4c49d10000b4bb837c49addcba49f7a0231f0691a46ec2a00239f','0x0565477431d65ec66505ac3bafb7fd669823c6c55a1dfabec8ff27b4b20c6e90','0xac5c8e318aba72c676d3e53de93bc7e30403581fc73f3e3b2f13418d23ccef95','0x7a49c869a64c6a5c7d29636044bca85a350b175486f1b597374e04fd52846e38','0x84309fd916a2b81c7362a26be6cd2ee4675bc1178d4be659756545e5da8c1d26','0x586854a63d1687d511a99f8bd492b9b634b8f75bec77632c32c5ef77bc04721a','0x5daafdb1578acf9e7aa4768a7c692a2a0f62cd6407f304d4562a3cb99f370068','0x1f8f14995d6e405544725e90edfb401a671ab70e8cf028acf94c0bb83d2796ce','0xda9eed487bb61b40c11a4340ca757f4b43836b713405db5669413bd3f5506250','0x2efc700b7d548348e42d2422cf4311a68bacb69b56dd204d5811b1607a2c6e29','0x89b612a97db69c4af2bca1852d489c4d9a1a238ac571131ca1cba4c12c72a369','0xa56ec804339b61689976285044f34e14a3f531c342c990a79930bd3f3c96329a','0xfe892569e21576f4c4ed7e9ba972a1685ce3ea668763b58a922fb38f8717c77f','0x0894a41e7635b2080ff80de8b197baf468014adeea3caf5ab43c382f92235843','0x9e2c32cf9821482cd91abd0aee17079b00c3a704b980577af8e0666b68e1b04c','0x72d90ce59504aed32ef92e017227adb8f5816d529e20e69a5bcef7ffb80d94d3','0x4f88b0bb0ab0a8420a57e2832666671543714e0089c789fbf76a3d31c81c9ca5','0x21e2f86d026a1180eb7614ee8f81d4aa4c4065788ee6ac5f660dd9e02a82bdb6','0x057dd077435f54a20f0d79cddd45866b7c00b7616c1f0586e3209999b339a4f0','0x13f8526fe101b7cfbaf269e051a1d17cf0eb47b995e385b99401819866384421','0x45ce5f66f11f89236935520a749f2098fc182ce9d257c023794ccbea2e0e628c','0xf32bed47c4043cd2707d6ef295f0d1e8d3b84ad3b25387f9636a838d2c9b416b','0xd432a69bb0612b51e3737d16482cf229fa1372dff6a0d06ef14bd65829c965ae','0xde12dca88e5e18c3ad428530f00c8006a4bbaaec21a3b1ce1da8c3ee1efda406','0x779289925bc4ca574dc64b5a54becc43590c4241bc2957fae5c0b59d65ae4fbb','0x03534b638a73a58354a45932bf6b7c686b902108c00bab4bf35756b4ecdac298','0x009a3c959d64486ec8ca4f7776ca21528a15edf6a4a0424e877c87fa7f142637','0xae365459ee1c95ea644b7c61f122c66a56065b247d7ba0bece6e95b467def010','0xf886a6e61b19a36908833d61fbde94cb9e97d45a193a83426e48e73b6a254c37','0xbfdf41c235ef859bd80813a9200a08765f901c2831b1aaa8036de75c23684300','0xd91ce3da5cbe28c3594420fbe8d47b40559b8c543256a23b1c65b8d68172d72a','0x90ca431eec6668e94398cb5a33e50c6103369334f716d655b6c9bd012828acd5','0x77c8d0229b4c0e4120c7337f6c09eb85ec40a39361bca363d04a55e03488a8a3','0x93f8edf09c66a1ed373ee4323fcc1b858bbc67c2433bfb04aa8a57bccf9d2bd7','0xf695063ac217dd00ebf89c4e39a44c3723f18afdefaa8d60dc7448d254a2aacb','0x1aff06d9fd0c2d8612f40c95aefa6e175d8d091b13996ff94979ff84f81980fc','0x2f6c5e678683096921c0390f40d46199a2a95f88ed7320bd7fbb44723ba28679','0x17e37d967a026b113784d14d792bb225f813792a0ae11e93930d0460a5258ea8','0x78a6766acfddfd43a1be9f3da2f238523e8a2aeacd1e6c6ae1ae411e2d63b2e8','0xcaceaf60a961fdba9d6f0cf6c9f80a86be6fa77557d5c7e02160cb73ec736657','0x99d4cfbb031f02dcc9611199f6df9bff2e8d8afef80be883e7d180f5e5244114','0x8e876ba70e321058f0b4269f99ba7aef2bc36ed14629feed81ccec8301772586','0xc5c1969440a313f8fa514a25ef0a3800ab0d1fdf9eccccbffcdd2f9cf9104fa2','0x576405c820dfa14e54411477123e22949eaf7cc426ebc460d5caeef9d5ed1703','0x5a93bac8538a1b824814bfb023e4a5fc1ceea5529e0c0705d47fd1b4c570b0f5','0x91e8e088e7e2ac3f33b4d9963b10132c2389726f9ba264366df83d04741a7195','0x9673086b64c6278dc175e6b7413a882f64737d80cac2f7972e5941ec77e415a8','0xad44429142e1405a5e90322d6fbb628504d7337a10d73d59e8e8b1b0597dd42f','0x1b1a729f852bbfcab61548da6cda3b1b2cde4cbc087c325e093ef10984c255fb','0x2fb98fb3253273db1f1ab2141931f805cf358bca76ee20c758d4785f47d8d2e6','0x39d9b21e143df9041aaf437595eca513f7128d6e92559c2152a02d8c08f08d66','0x23b3042ae2a3a205d3862eefd8d269fd7447f1df1e08fd9415843a006bd96bf9','0x14c2ec5823a8751cde42ecac999d94d992fdd4480396433a6838b78c2c5a101a','0xe92d5782f4013a6955d2ae73e675b3e98fd7ff6c4b97d8c7ee212c50c685f0f7','0x69fcd87fa2c26b2d4ee106fb280a8fdbbde19b1e5960ca948ae692feb5f4128c','0xcc9b105905fca6d10744c997632680829f2f34c103e1c573f3cffb877fd96b40','0xa24cef5c5d88170050b9f495857983a7f4040f43473f1916837435fd6f1e35bd','0xb19719fd472b9451dc10f43575c470da215769e482f1cb6f78ff3c09bff173dc','0xd95ff5996432cc71d5a424eb47567cb437dae6a154df44c9df73b1fd31273848','0x0f1598ff00d5efc60339a5145cab566900e5047161685a355542b94e792ae71b','0x9204b4937f7481ae75e90f65c7d27d05f8c7de555171352a008ae5c728d12550','0x4daf5aed01f81e3017b6753888e6ea1918124a4cc15bb1ab0b69a8b23c39a37a','0x4c50c470eec4c602a7293948f191d990e6fc54b263717dcf6d8f1c2107a74337','0x2b721daee1571f64a4a91ca216bd7c44f7820fde62c4c7bf1b656e3c891522b6','0x2266cac49ea547da5ac38576e53f717f2506900ab13da408d23bfc9337aed20d','0x9c2cd7562c99a8d18cb42ff3fdf58a239e13cf5f1f38018df959182cfac3b2aa','0x379a723c8dd66fbf70b24841b6bf894abe6515d54ded787a82208d8fd8f8d147','0xac0cb7212f3b22991f47ba7279f2f8f84a06cb203beffcba6f3d1f14c6a7ac3f','0xffcb263640c300a16ef3bd1bc32eb5c8aeb28b9d22d2741406e4a6ec91fc781a','0x54eed9d8b27cd45df44d296aa2cb93aa5d0fcae4ca83673c5e872336cfd45312','0x2031ad6a531c1a6ad37a51ceb9795ef3d0ace6cd90c4cafc5753523369e59821','0xbdc356a9ded4eb2211a0de703b8e2f5aa18d429173a46283b403d560ec8845a5','0xd664115fd25a5eb6bc8b7eb2322b75168046d7633fce4efd51873ebc63a2e642','0xba631c7bd927f1073862076ba9b80ba78097796fab7cbb76f26ea2b24f4585ce','0x49d06da347343eec60cee2acf3d1c71832daf4385c033daffdff1154d4e76037','0xb079e74eadb1d4d13d8c47fed09e1467395c76dc4d806645efbb80231c15359d','0x307018a8b5adaf8c9a307a3a8d2644bb26d71ec38e14fe27f0b9bcf47c8ae9bb','0x89fa37f588ec25d67888ec5c3c42aa609b4c81d9d64ae22450b84ca9ab384392','0xab25c059d6116742425929d83acc07f7defa3322212fd698cad4d107239e8307','0x1fa64c61ae940751770f760e175a152c0b8f8e7a7226ad24877400424c6bdf09','0x7560a0416ab649225d85bba2df9c9afa15a90a5a259e99deb2af4da04f17df33','0x425b5721b8f1c948333c4bf5950a705d1609b077d5c0ccf4d945a73924d65695','0x4744b229e7bdb1a246697d9363b0d11d81db0ec6e3c5d8e55dadd4e33383ef2c','0x4f6ebb66c3ae376843bbda8b5788fa1579e200f5795cfee4175a79dd8be10f4c','0xdcece1be317083304b816ba036d14a51516d2cb1e75822da5cc31f559170e487','0xa0b7f25f539d30c6ec1412d04ea6cb08e993f31323140881709eff175e2c0d8f','0x8ac4c0e81323e87bff1f330f2f915b6d374da47164106b4f925ecc3c10267c69','0x5b929019db73dc239f0734e5f6d122d989696df76ece140914780dd29f76090e','0x244841395ef57660f4216fb6a1798368cdb6044c9b21207a8c25da0f1423590f','0xce3998f21b2ddc1858820d181a7893a3e4bf8529879561c8b3195478fa7797d2','0xa852d2a393fa3c598db60a1abc042f96dfd24249a8a04d9ce6033c47f331d941','0x61b25f4f4a678d9e3bef5ef5a447580e36a45b42bf280d69c8f88f3121bb5e10','0x2addadc39f179b45f5b050c513f0de91da33b342c03a52a2c8dd14713653dd2d','0x42b67839f59c6907183174b2e7bb586fc10cf5fb99d91a47acafde553c6e608d','0xade14aaae740534a7b7b2fdd40ebeaef636c1154a87ad97daef35c841fc3f656','0xf7c9cfd228ad1d64c1596de100dd111eb323ad5c8e0b6d2880a7b7054ac08943','0x13ac90fda60ed1ffccc8e1ce7dc9335e430d7c2469cfbe50b8f595a32da31ff0','0x35f018bce287e9dca26ec2603994c0aa6e34614927fb70eaa99e999bec09851b','0xc22201f03175868db5625b2762ff928ef316555d85cdb98e9cdc782276a465fc','0xcb3cbd72be274c246b28c6bb7bba91930b060286d30ef01ba8441c12f9441910','0x082c3d38f22960821d13fe5bf8b40cae8294882ace059f75be884901f8fa5116','0x1f2f093c90cc530691008359305f99a54677948f7ad6cf1d8ae3c9d1c847a6db','0x4f08050d59f548cea91f2a79a6424d946391212403c953738a4ea0b4f6556192','0xe405958efeddb892515489d5b246e657c9ea1448985674f7308fdb633f19cca2','0xae5da5092db4f5af7be8f070ef157cbeec3d225af8bfbed797dea8f8e3908267','0xda4268a2550ab7eb53747bc7040c7a0b24df49e3ef18ac9022690deb23e67cb0','0xf234d377752d650f6af6a9b6b201614b071a0be66e1305aa178a218eec9a8958','0x3341f1abba7cd5d8c029a7e47989a9ed3890b5562221c41b879ec56c2dc25d59','0x8d1ab820737e97085f72bab2fb21fdfeefd8a9192632cca9a5363c0f77d6c395','0x334044085b87679c98ed5e882103170d77afe6726c8451c41360aee21f00d3a5','0xc480a24546ddb61c5f73cc3d07e98d10accc68471841e6bea1a5a45d350f9292','0x879e3ae9584e2d1c54dd9aa800a05d98648e7af7a0cc4f258bf18b0c20b24fdb','0x7e107b10cdd2d459505643312cea59a8c61528a85b2fb74228115bf65b6d28af','0x0a6d79ff9f670c2751c7418ed54dc01a07bd1c9e610aff8321a3f168c16874aa','0x785b8f567a2f11ac47716e1915f6563e5e80003e44a9199f9b64aa99b1a3e08a','0x72a53c89948845413efce8fc6d8bedaf0c96daf9e0daf542c102f7ac9e8d747f','0x880cc749f73c2424ca70a005f4946c2d785d166baa4acefe51f54eed7bf0c536','0x99c0310200bf9d0d4b3dc02ae2457f2bec25b77ec76f3155ecfad6b60a130b86','0x7736fa87b517baee2f3d6793adfec942ee722778efaad803ff682be8c2d29e4c','0x3941ca49d8ed54a951ace9326d352fa40a8eacd6f946184b4cec56009a73edcc','0x1a1dc227399eaa4edcb5e169620f9a063c614625637bb41868aa34477de827d8','0x143e907bc6baa0cc299b32d02ad1dacc5f19b6174c936d78457896ad711cebd6','0xa54b9b746d55d6b0ad187db7c566d257da9d5b5d1df71b753ba1750a91ba22ef','0xb13f4ba6bcdb6de87ac71df6c919a95a92ac3c9aac4d9b7cbd4f0df0a9ce9dec','0xc744957a63b71916f3cf5d9f3f16d6db39aad309cc5312984f0ffdcbb0e328c0','0xeeb7c3c9520c03a4a3b740d1d23d030a852a1b4a700b63db47462475facc38b7','0xb3edae27bd789f98c71de7b563f8194a28e0a9495e9d8e92c5f5bdcda0695599','0x3ff3510696dc75d522e9fd2cece678ddb8e488c82a57fdbee055adca48203f29','0x7c8664f34cad7504cdad499eb455f370486b72e5511cf27a948a2ddf6801b04d','0xa73f22a7d7e2c7b5e1475a9028539fda48ae1ac29c98b14af7d8fe876603e8bc','0x5af4d486edc0a29040774615540cad682e28f16000db419a5789d0246fd71cd2','0x681defc0fa3e00f74f8e6ee8233ef6bf8de29d46e114990cec4bf85b33629dc7','0xbd459f00748a9b4d799928ec7433f6b1b605182a8a0ff4596811862448b313cd','0xbb555c1538bf6655b17b3344146d5e49fcc8a4da54ae864397e68ce8dc00e6ae','0xfce145100cc5a76b33c9675c07beb632b93531a1e084142cf5a781b1626eba81','0xf695fa8f8ce509c978f76c5df351763c7a4a5366ff2b636dfc81f88c850e3fa3','0xb6cdfd554d01aeb7482f6b692d71ed3cdbb924b4ff8dceac8aafdbd1cebaf595','0x5f325c8a0c67e558b968325ac4afdcd220b3e36d0cce69278683baa4ba42f6dc','0x669d97539d3765d4939b76b9117ab86c5b9e5fe16deb2b4b2d09ad9d8ed621f2','0xae68497205bcdae621fdaca7c9cf7723f4323e55df914fe8250f0072c60b1dfa','0xacfefc65718b9d404b35d356cf2eb5fddafbfd11149e0395baa229eed57f5acb','0x6b3b9300a0fd0a8b105a4e9588a0d529a883fce693927463ea442b5cc6f2fdf4','0xd39acc64bca31967e7c50ca8e9cd9f650ad07f0f867c10a69061cf6e7e7bde60','0x5063066621b4ec3b583bc5a87f00b4611a410e159529a774bd555484d28bc975','0xc9f89e1d08265cf5a97684283a681335fa2beb3da6fd547188046921c5cb9dbf','0xd16ba6eb9afcc13c0f34ce51115d8c02b90c113cbb254ec9e79f067d168c3fb6','0x0c8fe63f9139a0c378a5987f3c5508cd291c94ac863b86175fdb93c8b5f467b6','0xf152097815097b637669eb2840cc9e3cfccd51bd77a159692d036fc2327717bb','0x32577c061ea95f1be5c7b8a28115cbcbcab8664f410c709cda85cfb0f10f2bd3','0x1ee3da153f4368859c79d80d4e9133df9c7c5b3f76dc1ea325e6e70752281a56','0xa0eaff5677402700a4a9ae4b3ed85cf950cc6577b9e93e3fa973b58183ab6a73','0x7d838e6a8744df3cd4a8a7cff647a33fbff96f7d3305cad45d600830d593333c','0x9f1349aea6671c12d1ef3b4152784684611c4b89ff7bb5f57e19d0ff8d63fd12','0xa2fe0538d5fc1be3e299db620265d16d551fe049c49413c931bfc6f8ac02c5fd','0xec172182e56a1bf2f647524a52ef8661b797b12437f803fc1dcdc2d62669e57c','0x757ba335fe32895b1dd7ee87415492858dd46799ae169337d860385f7a872b2f','0x7aca91e00e8eeae8a813f83f20a0e03863e432a586da35b7c9593b94a9ee25f0','0xa1b6a5a3a6b6dbd50dfd1b89d7c0cda998df858d4581ad0e9a0a11e476eae141','0x5dbf91aef12486e3a5c2ea760de90168c8d32574f66e8cca7310425a416ac63f','0xe2b998f7487a1a3af65b3ecaf6571ee3631729c308f863e06be7d02905cb3edf','0xa403d6bc6e41112037486e7c24283bb5bcf42cd812f18ce0b2d7afe02b67271e']

// server 3
// const ethereumNodeUrl = 'http://43.201.193.35:8703';

// server 4
// const ethereumNodeUrl = 'http://3.36.183.216:8704';

// 웹3 인스턴스 생성
const web3Meta = new Web3(new Web3.providers.HttpProvider(ethereumNodeUrl));
const ContractAddress = '0xB07C758b16c43C01D4e182FAd97D8E8Ad85e0EA1';
const ContractABI =[ { "inputs": [], "name": "amount", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ], "stateMutability": "view", "type": "function", "constant": true }, { "inputs": [], "name": "recipient", "outputs": [ { "internalType": "address", "name": "", "type": "address" } ], "stateMutability": "view", "type": "function", "constant": true }, { "inputs": [], "name": "tokenAddress", "outputs": [ { "internalType": "address", "name": "", "type": "address" } ], "stateMutability": "view", "type": "function", "constant": true }, { "inputs": [], "name": "transferTokens", "outputs": [], "stateMutability": "nonpayable", "type": "function" } ];

// // 이더리움 계정의 nonce 가져오기
// async function getNonce(address) {
//   return await web3Meta.eth.getTransactionCount(address, 'latest');
// }

// 서명된 트랜잭션 생성 및 전송
async function sendSignedTransaction(rawTx) {
  return await web3Meta.eth.sendSignedTransaction(rawTx);
}

let contract = new web3Meta.eth.Contract(ContractABI, ContractAddress);

// transferTokens 함수 호출 데이터 생성
const data = contract.methods.transferTokens().encodeABI();

// nonce 가져오기
// let nonce = 72;
cnt = 0
router.get("/transToken", async function (req, res, next) {
  try {
    cnt = cnt % 250
    // account 불러오기
    const account = web3Meta.eth.accounts.privateKeyToAccount(privateKey[cnt]);
    cnt++;
    // 0.5초 대기
    // await new Promise(resolve => setTimeout(resolve, 500));

    let nonce = await web3Meta.eth.getTransactionCount(account.address, 'pending');
    // let nonce = await web3Meta.eth.getTransactionCount(account.address, 'latest');
    

    // 트랜잭션 생성
    const tx = {
      nonce: nonce,
      to: ContractAddress,
      gasPrice: '0x0',
      gasLimit: web3Meta.utils.toHex(210000),
      value: '0x0',
      data: data
    };

    // 트랜잭션 서명
    const signedTx = await account.signTransaction(tx);

    // 서명된 트랜잭션 전송
    const txHash = await sendSignedTransaction(signedTx.rawTransaction);

    res.send(txHash);

  } catch (error) {
    console.error(error);
    res.send(error);
    // res.status(500).json({ error: 'Something went wrong' });
  }
});

router.get("/getBalance", async function (req, res, next) {

  res.send(contract.methods.GetBalance().call());

});

router.get("/getTotalSup", async function (req, res, next) {

  res.send(contract.methods.GetTotalSup().call());


});


module.exports = router;
