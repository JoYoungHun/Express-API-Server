const express = require('express');
const Web3 = require('web3');
const router = express.Router();

// Ethereum 노드 URL
// server 1
const ethereumNodeUrl = 'http://43.200.240.107:8545';
const privateKey = ['0x021c90e9de1e5fe70688778885646cf8a921c5ba14435b16ead915dcce0e50f1','0x9a84ed514cf744cdbb42bc3473926266b44297f46dedfdecef5ffa6f2c36f060','0x551d5ecf055f75adf11997d19f65ac22a3942302d46b5030a44abdb2d9117d52','0x97301b9b0b42c0312033a434d2fca7cdc6fc10df31971c79d8c5787a7a64ef24','0x321a3671f84c4f84eb0ed58e23b2369de9925b54ddd8d391c9cd0e1c0c9eefde','0xd1b8bf250161d9095bf486699e6670d6e6c6c23099055f1f5b221991d91a084b','0xe3ffd867d43f2996787642e20b794bc338501b068cdfe64e089e71c30378aaa3','0x0b074015c96cd8aa8ba8d1290b84cc7814ee233ccd9deca428bcc1ae51431bce','0xe3f56d234d0ec41d3f68323142c1f55bbdd0172d0938696a750454bf4cc6522c','0xbf45814948107c7f5b13baa93a081bdf4086cea7c298ff959b1ac9d796e62a2f','0xb183a0f8e792e747c828b834c80c3c0e3cecf0be6996af27598c726380236689','0x0d01ed93c4d13230de561d18fb39c81c7fc4619dab47002f4952e18196d9b3c5','0x1ebf6698ec7e0b47b25e96ed6b5319c860dec718baf6b825cc83e57b456a9166','0x0763e29a6c4a897d2a550cfa94e6955a9441534d436c6822b2df6d25f62ce559','0x411126c56f32ef86ff53fc1332fdb38137027fbfa088930fefeedce6e9756a1f','0xce8e19ffb1af2b171cfa676982310be0d7c6d6d332675e8da0e85d6e5a2bd00a','0xf56778868756fcadc22612d1260907822b59769aef6c0df6039421db10bc12bf','0xf36de436f4b4630ad07d50cf6936afda650e6de80edd88bf1f8974fd9484167e','0x8659de59848a9c311fb65eb7b901f67397bc43dafcb0d139f48c50aa28448713','0x70071da4326f89d515531bc3e9a82de80ab9a1b5cdcdf6cb49d7bd0571c465c1','0x3d92875b5ec3e2dfc6ba713d2698b37b3fb0784560b1a98053479d48d6953da6','0x486141e73aa9cd18544e27941ae57066895835d199a3774dc2022388cffdb103','0x2f4c757a8a311243df90ac1c6b3b95b54da22f280cfef09c7899d4a655653b35','0x883619efda31897751dfb5690b8c579afc6dc688c731081790e269d67a111e5c','0xd048cbe6f09f4b433eb5e8bcfdcfea695072ac3294b96deabaab774bd68d5406','0x2c0654d88f2c4b728fb8d0a17b0d57c78874656a7a9c7fb19d562162ca446d35','0x8fd586d3e774c56852f5e6b8a4164856dac0e028ea98e2d90f3a686c949a8455','0x0a126059dcd79fdd751cfe3f7fe99269438fb00cabb364173183f87505bee0f4','0x9b925568f894d670539f38135b6cc403ddb0c318ad6180013b446d670cec2636','0xb2dc6599b37cd632d3ee6219eb9a71c8cfcf1827be6793bb28c97cacc62cc2b7','0x499393fb3b508d7b5bb2c58d02a9ac7bb4d04b1a57a7850324adf0fd0fe130f5','0x2ac2c90df2a26f1e1ce281e2dc3019109638a18a03cb325a88fd7f6114792a96','0x8a6a74c6a3cff48aaa6d73a65d082c74806c1c08ce9a4ec605b8278c05cd8e72','0x3440abc9b066b1da4a7b895d74b01b791c1a6965a798f0b6c2bbf24065cb17de','0x9dff5aa5bda454365c2241211c5ca30f858e4f55928c427a7a1c8b10b78fbe3e','0x8f7632aa57d2464df25ab4bff4244d0405cadfc01d9325d7a79ef830eb2162dd','0xe08053d2b02d62b32271f6facb80e66580202074feffd7d72813b2c25b7752e1','0xcf64dfd4369bf52f1e20560d8ae73d9399ccae0acdf9a38ee3df1b29b52fbaa7','0xa254f66764c6ae5ed28e3e0e0664ccc3d5807e20852e0633f2b3d77bccbeb66e','0x7b7c327b25739ac5c384642e68cb0d6d6f61f13f60c34f46f31261401b6b61b6','0xbe084a368d1dec78717e9ca449e821ec7299a7d10ce7463d35ba6a68d8938e68','0x82a038b3d77abaa458b1cf588d7c758bef84b8029e3e8984103b88e7e1d29d58','0x988457000fd00c6eebfedbb7b2496ed1464baec60a16174afe352921fc9e025d','0x5e32d6b973edd1b8c612bd39057b21f6e5cbb274b36eca7d48b46b72fbfc5ff7','0xd4413dc981da9630a8b90aef55be6bef1a8525372374319d03e0368ea9a8388a','0x7252ebe119f71e6466232be7b54e168adb69107dd06a767bc0c75177ecce2d34','0x493924de4597601d050d51159090c8d7ea4a0c309420e2966c19766aba7f1be5','0x3b88a04eb7fc673cb8d91f820ef607c96a2f0929489fc60d9fa456874765bd5f','0x06d3c9fcae7217b0dc4c73b3f9bdb2642e8ccf32638768bfefc4c6df3875cf16','0xe4949ec7e5c2f4c4a84dc567d1b088bc082afff4b6a0ed15442c3b83119cfec1','0x5319c9ee776a5e474c83a847ed24260978348bd404aaf760803ae0ad69bbe699','0x5a97c3c509a77b7eb03efbcb43bff6e10eb553234f335caef6a45a21701f1daa','0x17ec95cc4d1e901b9944187cc56f2303b8a5d3820228dbae025077c2ed367ab3','0xe973e8a5c98dac038ba9177f2dcaa3d40838ae56872f772eab06865b8f6a1043','0x20f8e11cc9623581f2090095bcbe4338a9c503d603dce276584e8a6ea00fa407','0x530c513536f7bcdbe25b1c18b8372bc0b3f034836e4511b2a239519f2741bd5b','0x5c3e255aa3e7a891f5ee095fa4fa8cc168618491a91682985b5e0387276ae945','0x638fa2db9281ed06e7787b00ef2f369183aea8a0bb0dbf5a2a3ff6ee8d4eee6f','0x6581364467914b70ef577e26735daa7f9aae54ff50cabfb7d3cf500a1376400b','0xb66ed9b39b2baebb06365fe61b851f557debe53a3e2486f371a0ea6c7015f6e3','0xb956355670b7454598da7bc4f88fc7d90f04f3493a3556581f1c8d8b0f5aa2fd','0xdd9fd5fd94905079f4099023299cfe5475ae4cb69c9b98160b97ee614146052e','0x66521c75fe0205c22970a8a75c3e627c9b31e283665625384956e9521ba7b422','0xd8772d3151b789614c18da8f297af939f2b31e9ffee7f7f08d7b8847bab83859','0x6305650423ceb0bce87e571ad7f45987b2686c8495070f1a0637a6784b7f874c','0xa802ed634c51c5b326ea9b9f1ead937b60157a59f683f81e357b1b482005c2c4','0x3afcf14a9a51a516b7068f2f9a2ae667f7d1a77764796a56baf344fb81430041','0x70b5554052d301154e473e924395dbbf96fbb92c3305f5f2c30e33b13f925c42','0x51e587ffdf25c26d4cf903ab956c483b6d65d7aaec51dd19663cfc351c64e2fc','0x15431926ac72d2f44fe9e8ea3159d74f5c0af678828e2c9aecb8977a338faa82','0x7f0de1b9935c4bb5d6351148124a5280a805b3588e04c8d0b87ab52292328eb0','0x5b24ddf0f54e9db414c800a0d49eba820755e8f0dec78a436c52c31fe43a6e73','0xdfe869808fe4d046e76d5dc912f9575a01998b9f39a2630ecdc1e1916e3d2e26','0x07dc778ac595dffc4d1dbdbfae53aca6e35b59ec486d02ec81892a6df8941790','0xd07d41b0c27e212025afc1696046badecb1e951713ff1f417e68ce0f72de22c8','0x03e19b3be5b5330431cd6de8711f03ff55d6e941c2d1986ebc167f869ef330c2','0x1b98dfec7b28084418b2f2df102c3c56de8f707ee479a44edcbb61674aa0f727','0x411e94642178d0058eef777521bdf5e8932865bd96cf6d816ebaace1572cfc99','0x42bc657399100e0e8647fdc8d47f83f3345add3dfae3be01cd128b7acbada9e9','0x560416c986a93e349120aa2b502efceb6d33f011722a3bf7c1bcf2e149fd98e9','0x53de599d6d8670750b0aebe3df84c9481c7327a4b7c65068cabeb017056d2904','0xcfcb1f6e9405daa62da8d0c5763ad97869295335ea989f62960ccd37a65ed4d6','0x7b4583cffdd9f616837adb4d552972340acf17ba828c5751c1e964157a70825d','0xdbbc5b0beafcff6b9ca499be7314bec20a6660c84eae099fc73e632bbb44f131','0x659444355036a042630dcb4e385fb02ac7a5bc4306e6b92dd4aa92bc997fb21b','0x7e87b2aada06d4106c9213c019bc782538dc859aabd84007de19c9c387f078bd','0x4e6f4b102fcef163d86053c83f05ea377684e810fa09347fcffbace71cfb9627','0x01c13fba5fda9b1e34c14f673c6a6093ff18cbadef1f4cc067a54ddc45ca0687','0x009182bc52002520989c37c0c1fe60f44337479d18b1c04f7f5fead049beb491','0xe3827315adf56d6fefc2d1e7df30817f712649e1f22da9471031f31e5755e778','0x765263569391f89721f820174cad5863fe8485052ed7bb0d4773121017a3ec79','0xa546be298c065168284bb2ad8be9b11be762d73f6521ddbd4a0d5e05a234d9e2','0x0740bad27dcd47440c71796cf8c19dddd2591fba73a0b81b7b1bcd3e2f3b54ad','0x604e45f4e2aa9f6298daac679df0628bd2a8f19111a0d23f927ee38f1340f4c1','0x181d85bf88f60920fe61d72fb47e37ea433bbfa5503e9159b4c46f44e6350490','0xc7a44a7de6bdaab4561b32b8bdc19e973482ca0261a50779ae2443008aa31c40','0x579b9f1a9030ba171f19640ea08375d6ed2a6e33e5434051ed58489982438264','0xdba43ae80cced71c5112f281d4553b3a0860ba83f9d3f18a1549fca7ae15d5d0','0x9e5a4436793a85386eec8eb2a94c4453c179ae7c45945760e67145a1b866deb1','0xb8d4245f7529a8fee55a27ed310b500cad24fb9a6fddce8b831f9865823f2cf9','0xdfc4aec0bb13e5b1b8085c4aab4c2cfedd60180d818e2b21a1712e3814ab98f4','0xe1bcff0d1d0908c4ec4f0878e4868898c1613dd2876c7837851e2edabf502a06','0xb61d744ad68d7d849e30e2fe22f5deb39eb1f2c8cfd3eb1a8189c562a0c7bbf6','0xb77a92e977085de8761ac7f59dc788e92b13a8b92ee297f6af0585686f2603e2','0x640f4772a5cde56113e82cbc868df6776f2f9cb6178c426c2b522505cab125e8','0xbefdaf49b2639517f0d03eb6e6027a8d84f8ea84631670e48093848a8c31251f','0xa61da8a88c7b1d924d1bd897c98cfb8f5c9d6f77e426236e969e198bdd47bf4b','0xad671175662f8d13ba53270fd1bb1e6f7f9a71c21b7b43d7a9d76107285b1229','0x60c1b059cf456da61ec4ab36395b060d5964dccc2a9c5fb9612054b5898860c9','0xe856c93c3c89d84e01d968d519edbb0ad318bcd7026d5840b0f71ae51f2203bb','0x67a886774a8c320fc4cb524a7e2a99c54d801409949762aa252b977661d7072b','0x2e471858c8bc9183f09aa2a8b11f252180987dc92f3f73fb4dff425ad5c92a47','0xc1f3ea281eec931fa1810ee79ac03247681d1cf3afd4869434ffbdebaa35d4f1','0x5b80b1b27432ef844809ee5da1f0bd7fe8fb3557dfa23a0eee45ba79d48cdc18','0x3a090b8b5be5efb4574569a51144efed8cf28fe6cd3d8e4d9ff5365b77516217','0xadc2705e6fee1a1ded781dc665b30ace6081408a60dabcb44b8e87d2445d266c','0x7136a961e5fbad7ed1090fede06ee60e3e25f4e21ff3d9a1f62b7af61918d922','0xed428e02a59399ea86ad480469c8ce243ad28cd61eae0fdf4518e9d7e3ec69b5','0xf789058fde84ded04e2333cfa3063c83adc75f4e52a2390e6d46dd406b42ef1d','0x27f78d76a6c1349e9dde45fb12e4681c21fc444ac783e4bd997ac9901990591a','0xdd08f3f1242c3340eba55db15e5bdc8651aa02dbb1c1f79b781e4133e0f25586','0x281faf2bb5feb2c32460c0b77b14ba209f14693489206c7464549ff3dd5cacac','0xfb944cef77c1c4b87eadbc2c8f586ab9e7e80df5f37c0faecd579114dcd27392','0xd8e8202f7830918f104662655886f6da441f6522c7d7c84a8dcd5a8e9713ed1f','0xd462fbb0de96ea9e123f7fecf00ed8c6885c43210e3c7a4a97b96620439e62c6','0x505dd9414d1e8d7ad07db1a8a8df5fec06ea44092670c60e438c2d6c86831141','0xb11398fb8be951ec2859a78a82af6c15355cb06abf969341ece431180c4da9a1','0x0feace111105551aefc39003053d00830d7a13191f477ca95be3e493b1e3e28d','0xefc154b51b0d9c9f2ebf144848983a3418a2b56db7c51d7beeed0322be232e42','0x3bc54241d0bbfa368a2b00c2253e5c44a467a2c45ae4e09bd997b245d5648d48','0x362395a1986e476b50a945f5d69cd49425f002f89a318453911c30be713af7ec','0x42ae6434383ac634a905bc32ad3906d573591214824d6154c911cceff2a725b2','0x9578294f6e690bd212176700a5665c8b695523cd44b7ff4b34270d274073f61d','0x808debd94d83f18d33bbc57d361b6749658e2dd7143e323259dfa8fe766db7ef','0x41052b6743be96d7a85b640a91ad6081ffb49ac3633135a651f5b8bbee53d10b','0x9669164b1c5a6650c9598e08c72cf41601a02aff3a8f473068fac7d7d81ac0ba','0x61dd64d09868323ee2b0951d1733fbf6f0fa19ee1a362df613646849dc4fc84c','0xc90a8fa7c40cf9fe2fc90663b5968ec92921a40edc9f0708bc1c6a49e2bcb24c','0x2ad80b552b6fe07be3e8b27a56e5298cdcab3e579ef1b635e5f36c932e485a33','0x92741d12c7dd35a9c10e60e826d58efd87a22cfeb5cda60145553aa62a6a3783','0x156d999707fb4d73ff0cc80486ef532b1220a69fdcde9280b7efe7cad76eeecc','0x23efab149a37484b7f78f996a0a25404d42c13dfa9c9e72378217f92edf496a9','0x2e1d4d9fdf12ed592f88483c3465386cb54a76048d4cc45fcbd6d9dac0396183','0xa4f17bbf7408bc1e9c975028c2c6d61f6d48a4e80feb261049e5426a9be47bdb','0x60dc4cc0c472ae014aa26230b777aa78259caafbc52cf62b10f945a18db4ee00','0x26f633f46e8fb5e458626c566f2078285c42fe49733de8c67e5ec57964f22aaa','0x94c0fe18793a11ef07cde7496e171473d569e2d1ed4ee0c14615fd2b31cde6a7','0x7d49478addc5c9681609f6fbb47e9225f1c965c5a1ac9df31875cbb27241cfaf','0x4d35fb615ca141176338c817a7b47294a05d687704c583432ac6d81c9b3f7a82','0xcc4ac04eb299efa6562a1e1b9c6afe4b3db76db5153a79652c46f4933977b51f','0x1c5387be46ace2eaa8d713d7dee8f45be03a362e6cc21c913458216a66bfbcf4','0x037fbdaaf8c47dfdc970fbff10f9fba7253e7b940881e535d63e21a496370300','0x55e23e09e69a38f8df9d49f711653ee803421810bf0f52f3df216ca136f8b754','0x4d42d84cd302b559ae87fd8f9853e0a4ea15830d82732ea9578628bdfcd32549','0x1a77a07c32f0178bc5a203b041e182e2e006db2b46abb0c75f222b7e26f5796c','0x52169f2437ca457c2bd5407254d1002d4358a91c065b50e69a4d70b23e7a4270','0x7c1cffb588a14c8a291cf24530cd39e287fc6ffa24299a9577a3f79895cc3590','0x2960e5f08a836504ab3abb642e47c23c806e06d1dc852eda904842feb96a376a','0x720b0ffb45d48541e9a9c75993f2b55281f0be3f6f81e5f6857970a5ea1f331c','0x5ddb7b991efcdb0c56ca7137fb73e78e500268f219ccf72821fceae699a71b0d','0x9448427add3610a8ee91c407101c050662ac82801caefee544441b50d515c2c6','0x61f13ae9fed482c6a00b1aecf4b41b61e63701cef58a453f79c9a2604e940f7d','0x3a7855b7ac37ce670987339937895307fabd94154b48061e0ed8180f7d92157f','0xd1170314baa0eace916280872e9e75978f38d4f3e7cf83512894c85e6bac0ec2','0xb99539f4762a97cbecd47f50ec05bd20b3f995d5e15e79d5b1c66f938253ecd4','0x87af04e3c3732a219e7d2d3e3f2043bdb5e6d1b1a54109e083616ea836016f5c','0xce95ea8cb1188bfd3eb029cb00b78225aa0110c553cb11b2b303bf8fb2d2c2f5','0xa29e191a6505eba3084bbdec3e0bc6fcb30445ecf0045d71704c7709e50fd83d','0x19f3e93f95e3c466b2f33c39ac979083c0aab69ec5feb4cf6a56ea7356f863fd','0x2db9900e03bf13c4e3db13679fe18ede127e7f1afea8c294574aa343dc707461','0xfa2a257e4e11837a3d9570138461e0f7cd3f93e5578c4211317528b24940f64b','0xe2927e1ba6f6b38e310ce42675bd30d63a480bf0867c0a71433d51a2170ec477','0x33b47c6b8edd81ae024fff84ac0ef9109b508953323995ae0df7449bf2f6e400','0x138d5d4c6030d2519f54be6d2cb5f2e9c25cfde8b381b5abcf2a4f0a5649e542','0x93ecaeca759a3b3db79f544459f2ee2836719c7bed88174b55dc0f74fb3c2933','0x0ef1d13ad73c0f8a4c4d81d3f9ca61fcc59dfc7e4ada010f69af829e9c9f60b1','0x4cddc79a5a25242ebb034f1c8b1890f198c4c6f9c98e46db9da32f5ceb620bb0','0x67f189f0092a2841c5346190938a386c7c1221052f527e6963754debf7c749f3','0x7f7ca6a515a8e44459720dac8b5f520fdca84fe83020c2edf3f66b44e5bd5044','0x4b595e59b153b6a5e51159f7a9d1cbbe2f699a916c3b1a4b9778e4481446b70f','0x78b5138ae8c91afada31163350d4288367ba8ca9d92aa3c6b5f7cab12d50ca0c','0x1e515e3abfd81521e51d88da4d8e7812da608ed926e4f0f37ccd64a3b3bb888d','0x082915ef8f28ab3d68d0ca9420b15f5fcfbf1f6ab59f89bf7b510358ff9c9177','0x8567d2145fdf44c4645e615301779c0b614df20c56f5fc8bee0971c94b536c07','0xc56d286696767f0e44a15c4ebdf7b24dc839a5edb2d44689a58c37c007dd9ed9','0xd7aa1e9238f25ec2509bb74909f3bd2823e9054dc67544f1f77e32716403b557','0x6b7b53a7aa87914cf6601ca342ac09062a23f36265186849644176e9b87f0df5','0x0d0b8d4edc9cea1311d5469476ad5f38e886c0cdae6a9b80054f1f545c70143f','0xa16811a419ab52a076c03597d338903919b94b19034955c02eaf6e982f56a576','0xdabcc29952cec545c98f7cd040e58abd2a0bab080a4437fb816d8b49de1bf577','0xf7de4158b6ae2969388e732fab9a152692c7ccd8073bd36989ad53d2ff346c13','0x54426b4ab8c00df4f056d3772f96795f668be8418e8d43570daa31407edc9fa2','0xafd87cad119e0905ea13d3e12e7e2baaa934bcb29bf0d7f7d144351ebbf2c559','0x3a3a7c24e7a142f83f4f200593caa435865ac0f15fd87715771c35664cbcf719','0xe194b6575da54a25bc2962224fefaed2ea762ba574f548b99f02f6ee9452aaf9','0x6970c911442a7bdb54b404d837d9de0de309fb34f762779ee6a423113041c65b','0x934ef8f59ec146abf294f3b4c4d2cedbbffb9c7656ed69dd3d1de2461d0f9f40','0x10b7fc7453c590fa2fcdb950ee9d95998f967e5006d9b72541381d94458c9ada','0x525490fa78858e2e9b92f99144738547baf871c29076cc9f3593988878dbda9c','0x2def8af52dc6a159a4d7021cae0845ce7fd29941ae6ee93421db49bc6e10e398','0x90e1cc72d2a7c1fc2c0daf0619beb1e18b14ef63d23d3801bdf0bf7454b1ac8a','0x68669f2d2aa17f32b5340ed1c303a8348f70b9cdf7e48a4cb660711b51c2093c','0x5051c7b83c6344b1bf5099275e3cdaa342674d535716f0fe5d1a7f322d1304ed','0x21bb129b495d11a920ed0d78815979bd38b5b99e1a371df6f5fa63de27f3bba1','0x5d845fa5c75e5bb6e184381dad9fcf439af330a57c4f2ae6d882485f956eb510','0x7390f3756c75aa81314e49c8cbbb8d22882682a270d47a8905f17d38e29d640c','0x4bcb4c3f033be454286c8d8af89e251b5ab37888f51e8870105cdbfeb06e5b9c','0x3bc1ff571955b43b320ffcd1b025a49f548a0010b9100772e41fb44c64b8e542','0x8d0ac0c6d0b0e159570015a7b7b2909feb61ec38cb0318222064143421de6852','0x4fbf19b6b48e619f55ce55e737c2d060bb30020da23b83cc90ad96f37db7b491','0xc93418e8c1d3dae34ef95e409af65b1ccdd8fb8b7f76a238a2e92650708ee58b','0x3c7a228480e795141125d71d3aa1d8546d866a8fe04eeb0123d8b46550fbdd1f','0x1eb56920cf5e8f270a41897117556d98316c8f088de7fd6673ae9a2a685ad0e7','0xbd66de64cf8509e53abf265a4e3c35330c198ad81a3069d642ac58d32c23227a','0xfcb17e23940e9ec9edb0c1de6118da5baa0e3db2c6cb40a6edca53a429e6be5a','0x937383658f963d860eca18154c50e72c22467b6f7ceacacd7f31c1f5821f804d','0x41c21c95f4497007899fbe80bda3c8c023f6d9a2b11e9b9d6b545e198984efcf','0x418e6dfddfaa3b88f7c3617e44e565209cc996400dca74182d9fc213d8d91181','0xda0f55ce7c0e0e403cb9d258b55fcc23716183ed9011b1f1c220474e53c1f635','0x92201f3b09bd44163ccaa78ffad49188f8303c4df503c555bf1dce1f62894263','0x82eda66520ae579c55cb2ca3f4b2a4036ebba95bb67ca3ba97abaa618d17feff','0xd52342ea7c45076851cf782c8ef6a306719c772f2f7eed149574f6a1297f559d','0x142d6106e8f7c6382764ccb95caa1248d48365671c367d91603d5a3fd7f3ce25','0x828c6f5ade8bb7e7a899a8d741ebac3842216a818121186461fe9b330be182a6','0xfbb2bf5115f5d4b508fcc20c3870ab4760a4ea1821c9c0c0db1df36bdde1cec2','0x99d3f0fd5cc0fee6e08b102602d8636972a4ea5f60676e4c5d809eddf8d1775c','0xf8f0346b734b07240d0ec0df6ab309419ba934f358ddfbb6f3239a82e18cef45','0xf41a425f8cef26c6a459401a4255beefbb686cb8c9b8516afb8fbc55bcc5c901','0xdbb6614db56a10ede210fc6dfd7248f4bb9463d3f530f488cbe3a0dc5070a606','0x11c9c3a1378840d5782bd412783e0490329a6fca5bfad7712c4797744c687b69','0xe8bc7c85db96e94c2c1e8a8175c1d9b2306eccb9aba9d7b5a21878cbdcff0225','0x202d2e9c73d724fe5b8095a65091f44e85190249772e51333450b8934644ae6d','0xa46d391f518b15c78e56647ef0d584bc9ca3ff16ebef507246394462e0dca249','0x6feaaca499614db1b7011777db0041229f304dec2b4fcaf020bc8bfb05de605f','0xf3c6929fa567a07cf0b20ca6a7a73deaee65705c3397f329c9054f24b55c9fdc','0x8a63ca9d017d79aae5a4b482aff6d5684c54ce0948555c9d7b390f239cfe33e6','0x9a00e54fafe26da4ed653398062123cc75036642338d2c0b29e2b3d2ccc8b9b8','0x11801a0743470ae9242351fc47a47b0eeea28bfd5774f237334a0fe67bc25dad','0x5280f97e13898e4e3df9b37827624795fafaef22095afc12530f7cea33030faa','0x3ffeda254b454101cbfb716af3d4b35d77d790249d993ac3f7eabed7b65c9743','0xff6f78688176632dbbe799ff882292627313255847e1592a77ba8790ca6990da','0x979b0371c30e84d511b84504e68c9ada78728ddd56f8872dc4ae892515ee0fef','0x935fbf0a58b9bab9eaa5ead277f57aa8082bfce1f185b73d0fbc80132a4cbed0','0xe850dc5c7fc2bb0499ac03d2c1689cfb7ead8f2b86cbb5b6dca661f5e98f0130','0x1a1c50aa845c14f81ebcb413e2fec6c651961130f619b980757a7d2e1baa185f','0xb8e171ea0c8b9acc6ed00de3243957ef2ac04c9c6c66b0b24280b75ef28d54df','0x073c957b9cc6674e92faef4ae3838c9c251076437ba815e054cebde2c002d005','0x5a9f7b636923ec8135caa345b9412feba5fe35cfea0bc8160da2e9c25552c825','0xd696fe3cfeabdeb70b8df51a9a56962df07f9a039b2c6352d13bad507cb27001','0x5a1061cee1b3b2872ca18597dda5dccd24c71c01439b40ecd6467494b0fa59a9']


// server 2
// const ethereumNodeUrl = 'http://54.180.210.12:8702';

// server 3
// const ethereumNodeUrl = 'http://43.201.193.35:8703';

// server 4
// const ethereumNodeUrl = 'http://3.36.183.216:8704';

// 웹3 인스턴스 생성
const web3Meta = new Web3(new Web3.providers.HttpProvider(ethereumNodeUrl));


const ContractAddress = '0xB07C758b16c43C01D4e182FAd97D8E8Ad85e0EA1';
const ContractABI =[ { "inputs": [], "name": "amount", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ], "stateMutability": "view", "type": "function", "constant": true }, { "inputs": [], "name": "recipient", "outputs": [ { "internalType": "address", "name": "", "type": "address" } ], "stateMutability": "view", "type": "function", "constant": true }, { "inputs": [], "name": "tokenAddress", "outputs": [ { "internalType": "address", "name": "", "type": "address" } ], "stateMutability": "view", "type": "function", "constant": true }, { "inputs": [], "name": "transferTokens", "outputs": [], "stateMutability": "nonpayable", "type": "function" } ];

// // 이더리움 계정의 nonce 가져오기
// async function getNonce(address) {
//   return await web3Meta.eth.getTransactionCount(address, 'latest');
// }

// 서명된 트랜잭션 생성 및 전송
async function sendSignedTransaction(rawTx) {
  return await web3Meta.eth.sendSignedTransaction(rawTx);
}

let contract = new web3Meta.eth.Contract(ContractABI, ContractAddress);

// transferTokens 함수 호출 데이터 생성
const data = contract.methods.transferTokens().encodeABI();


// nonce 가져오기
// let nonce = 72;
cnt = 0
router.get("/transToken", async function (req, res, next) {
  try {
    cnt = cnt % 250
    // account 불러오기
    const account = web3Meta.eth.accounts.privateKeyToAccount(privateKey[cnt]);
    cnt++;
    // 0.5초 대기
    // await new Promise(resolve => setTimeout(resolve, 500));

    let nonce = await web3Meta.eth.getTransactionCount(account.address, 'pending');
    // let nonce = await web3Meta.eth.getTransactionCount(account.address, 'latest');


    // 트랜잭션 생성
    const tx = {
      nonce: nonce,
      to: ContractAddress,
      gasPrice: '0x0',
      gasLimit: web3Meta.utils.toHex(210000),
      value: '0x0',
      data: data
    };

    // 트랜잭션 서명
    const signedTx = await account.signTransaction(tx);

    // 서명된 트랜잭션 전송
    const txHash = await sendSignedTransaction(signedTx.rawTransaction);

    res.send(txHash);

  } catch (error) {
    console.error(error);
    res.send(error);
    // res.status(500).json({ error: 'Something went wrong' });
  }
});

router.get("/getBalance", async function (req, res, next) {

  res.send(contract.methods.GetBalance().call());

});

router.get("/getTotalSup", async function (req, res, next) {

  res.send(contract.methods.GetTotalSup().call());

});

router.get("/hello", async function (req, res, next) {
  res.send("hello")
});

module.exports = router;
