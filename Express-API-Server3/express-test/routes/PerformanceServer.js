const express = require('express');
const Web3 = require('web3');
const router = express.Router();

// Ethereum 노드 URL
// server 1
// const ethereumNodeUrl = 'http://43.200.240.107:8545';

// server 2
// const ethereumNodeUrl = 'http://54.180.210.12:8702';

// server 3
const ethereumNodeUrl = 'http://43.201.193.35:8703';
const privateKey = ['0x40ff0b80e3b42357f2f4e56f75691fd8035edc360e5469ba165dd0fa70b35d2f','0x038cb3b396b77ea5036215433c847a5205aaeb74ea8ef962e77dad6d9d4267da','0xddd20ed7ca33d29c4771e61d802851f46ff7a24074ff7d881aac602029bb85a2','0x7de1edccaacb43b81c5ea530aeb338746d549dfd96eaae704cc98aa0fa72abc6','0xdef6187ea28f296afce86f5756fb7f53a059eef6e25ab2d774908fe06e4b0d83','0xeb50ea50fdcbedc2bc5d1b4ecb33a49c5b30c5367421b4c42f1e8fdd867d87ea','0x4a7a0754a25b8f63fa5ba4699ff3b33e04324b097c0754929d9238836b0e6b9a','0x48852a0e0efd3f51aee6a5278b752b8a6fb79d0a1531a561bdb2c075a6ddc4fb','0x60261acf082a845e218883b0be11db84da6809ab60b362699a2eedbbfa846599','0xfcf6217f3576f039c5df39aa2a1e21eea86811add62de53ae2462939c281349b','0x1789464da6aa8d39b267ff75e6b2378a617bb067f09857966b5e08ef28ec5990','0x76bd500ed03d2db44f0e80e87827bb9d6401f028909a2de5f4c589ea4ea9d305','0xfb9b7982a74c9e04bc755ecfa251b93135dc341dc195986153392755ea9e05d6','0x00500343e2cb62164d76adf36be34b45d93b865c1cccb53200ab70a68c0cb65c','0xfa3c560f88282443688498a9e0834fd4dfc633ec0ca927f9a51c8782c9149d94','0x960818044bdd19e67076b6a28eadb17b7247c1eca9c3a96301ef42325281c85a','0x76a661cedded3e38c7189bb7bf97398cd4fada73f86516aa37739e0dd1fd2537','0x4b2ad254c89cda38f9b017e3a66a6af14604c994afcb96fed931b14f0b1259ee','0x9ef3dfd2d1399bb38a802974db77d0189d7c158be1816e5b828523c08c57330e','0x6597330d2632c0aaf0e00c272ed365e4e6af43d948091894aa21bcaf191d1b55','0x454b4f74e5d6e5ae16e6eb5426af89b22ffbe920f9967d79f1883665514b4f01','0x1e545c1def35a3e41a10d6d9a6cf1cffad9f5a79b72188ffa1f50076b988916f','0x489d9ef995802952075ca778e636a7c708cc4209eb98c7a7d0c034ded6245152','0x2ca825b26eb080cad345bc72685eb26512f794949b2093ee1097bf4c19773526','0xac881642a14e8656f9de56831c4da684370a4e18eda3e8f1a85444342b72bc8b','0x68f95ef59aac9d82bfd5a5496d05d5a6e13d95fb11ed0549ab4f3b5b80d96985','0x1dd0b5c3d14fc84400f2c572f0fcf0bac668436b54258748d8a8322ad7c2647e','0xb945e63f213596f1dd21b9a1b1c55c42885f181ed7bd5ae1728915e3f3abb102','0xeea2cc834aa3931549015ea6a86dd726c73c9615125b2bce968ca67f33b5e882','0x139299a80c7bcb52b3dc6b7089c14ff25a0d9b9c2ff3e2da9ac6ac4f86ee1309','0xdfde78d43f8be46ae2bbab6edc75e2a3d485f80cd817c9b170a7315f2c459b73','0x8fd88d60eb222ffa737e730792c5a66110614441ca5ed1ae61385a47bb34e9ee','0xda9e7c8005adc4a73eac311c73ea1f9292137ddc5bd9227ccc41571b13d56f2a','0xd976616915913f5cf83d912c6740388415ea4f6c1710a17ff820ba5ddc146915','0x1ea94c5aa95d27bd0a87b1951bc6c3b54a8a9419c299f778c68446816ba69c53','0x77fd9d613c0e89a8b811f09a0f06df2ddae722706d5689a561dc66e605d16ac1','0x64678029aacb856e7b6b92a91f98a47bf510379521bfe2c0b7db1c34e3c91488','0x563dde4e214dd7de5ab2195cad6d9fd694220243249fd721800472648bad8245','0x31c6c9abe88b3b87efe1f05ef015522d1916801201ffd840ba3a37cf9539288d','0xc0e9b6f1d4ce677826f27279887c543563043cfa2b5c92528116ec09909b74f5','0x361005bd2ba8fde2309a8dca0702079c6e64e39f813066089acedf4e4e882b9e','0x2e233c929898616fcd726ca9f7ec9868524b272399faea54591598dcfc4c4cab','0x6e371e040d542e2e966682f8895a755091cd907e80e4b68778a451daef2cfb34','0x137bb79284fc24523e31147851c8453cb1dfccf2bf6549ec357fa3b44d1cb647','0xc347a24817913615e0b1959b63138dfca520d7cde700002230e04868ed5d8217','0x4896e25fd53dd86d6b57b5e385e9897c61faf56df228c1c30bfab2014713352a','0x906a41d48b84bc58a2060cb12165c445c71ccbb7694b3f3eb65d85161815c25a','0x6ec0e454f39781d8c5be734e39e38ef0ac039a54d1a52b7cbe7d8396e52b5261','0xdf65918c3c838167bb90a7962144c35fc9b5dc33de5e07682e18bf99b4d62fef','0x1eba6ca59a15ac84459b8ba517b79785ce512be88091aa84a5133e9582ae487b','0xb322fee315dd0f2b935359e8428345512ca501690bf7d1f3493b5184010feabf','0x9b70fd88c5a08d3dae895647a36d5fe481d60e3a88a5ba7f2536ffe3f20d96ba','0xefa0f9499f8f7360a8fc73ba1219a827689b15f212f0f6d0f32484ac8b9615f9','0x372c35104b7902cf991cc8fd0585633e6cfb773d1b4ed42735c477848bb70b12','0x6f35ef74c4fb02de34b1d59ae682299de9d6ed807cec391010c6e86792a05e2b','0x15ba6cecdf851a66999a98ad374bd5e3f635382e43d7b0b1104171665efc4fe1','0xe52d2df69f939f478722e147a95f15cabe6bf67173d456e3f9273d8648e30acd','0xf88130ea7b43e0681feba8d03d863d3c9a06f983c4bf88c60431126a9b9d6575','0xde4bb0508d07be034f49b3942caee05469b8d8f1dd592522297f57beb1d108b4','0x0aea053614a3c4868723e949ec876fcc60c32bca16be18fbb10255a29693b260','0x851e2cc081134f753621d932e0e1517a95f75e941ee44f3a322accdcc50be509','0x93dfc3d02613a73bc86b2a1decbf3d82264667cf0ac42d2965c3aac85e2ac17f','0x561c75bd745b75d23a32cf8ad19bb594c14fb9fc225b1f711e0457a2c8a58cda','0xce034606e3618e2ac27b1a4ce53ed2d8035a1f14202331f1bde0f5f9d217160a','0x8245d999076abffbd4a59715ab56139d557328e1c2b646c850990f78f524351f','0xc0bf9afb1997c05b385a6991492cf94c90dfc0b45676b63ff7efed096d115d78','0xba32a16b6f0cc0df83ec54c7d4bd8db75f65c259b9af16befa0558e9f48f50d5','0x0176e8bff57026c0b0ea3478a84940227d72bc4a8766d7240a189197f60cd450','0x791c2e4623e1df1d78d9377778c45e1fd8b102018b6dd906570f4b6dc46ed513','0x0239b5e38650a4ba8f2b79f37bfd07a3e217f0bfdab76a321ae778be508605b5','0x500752abd999c27ce76a67739986d396108994f4201467ba6aa49d4cff26b3a6','0x57e04d3af66d4ca604220ed6c12d356dd88dd6946071a7ac263a254ede59b7ee','0xb4c194cda51f225a5d60c6b11122025f12aca9128f267f4dec08e9aa62d615e3','0x531e384af95ba2c5215a9d946fa7f4a966de0d1f58da34642b2a3123e1cc9a04','0xa715b8d40ea00b30db09d154a7a047081c9a82b508ad7bacc2188594d6fa1e95','0xc27ff96fb6ebca805c0e7a1e049c87e46184c93d6a4c54262d0522d8618d8002','0x8659e3290d88559e6100bebfc052b7b002dc69b3a4476a89e8ffaf69b3e98aef','0x829290048c1dcfc45faffa096f1429185fd0448e4d86aba4877abd3620da16d6','0x07ffd7c7ecf0364424df8b9c30faf0e87e3d8d67bf6bce7aa74c3530901ef5eb','0xc5326cac8a2e2873007e515cc6810f537b79854dfb57abbe19c6b423fad3d8d6','0x436fad54d326da0370bf390f109fc1b08b6af974d03cfc680a9d022571d4516d','0xc210b80714d6739536813eb4b6e73fdd2f3ad59cd0a4d8b2aed973fd8b5e76fb','0xe233c7fc394542c98fc7ea1f7cb040958d79185f443d0633f6263be0091a0587','0x774a905d86deac70f9fab63316d7539d0883341cc9525ca74bdfba42e92e423a','0x86f129403867c35f939be7928202c865002028cd122ef4f6c1a72cacad018d78','0xf440facda157a83275d1f77f98ff541ab301b726f52f9085b2c897318e77602e','0xc9a825e5e546895a9d95f314c9889b10f3431dde681428cf190f190972613bec','0x46f1a6601f169da6367203f699b2f2d9afa0fc5625df5e4c40902cd0117c3e5d','0xed339921b45e60636357dfd5a4a53c3de70a9d6ca891f8768704232d13320a52','0xce8342efe928b76b3a5caf195046cc5d034abe0dc639a6ba6fcd13415b3d4229','0x7dcc5e8e62e2a3af88a1a850e13308aa46b01eb36473e59edc24f3a93a33f204','0xe348fd20be795295b300455305ab1913b18e65b8cd542e4237d25bfeeb4e1ed5','0xc1b818a603161af8c7c4064429744373bde6295278f99b2ca4a31866fd4ad2dd','0xe1b5309e15f909e70a472e9276acf6707fee1617d36f9e202a25dcc06aa0f600','0xd7b31fdd2c1d45949f1682f4205d86ac71aad3604391c3787006474955fa1ca7','0x4275a71f0ec67400c8b5e7e9b08a84d3826e0e955fc1e2538cbd2dd741593925','0xb940012eac447181eed200b8e0d1045bfb2d4a04f65a24bab5cd070229f0026c','0xce34b602dcdde94ef26714ddf1a2139eff9f8a13745840e05900c78044873ba7','0x706d78bbad11e07e42346a999651a451f943484d866ccd380a01ed46fd61c58e','0x76d86953b6e6679a2c175f8f2a91219f7d2b10b4dfea1314cb7dbf0ef3649ff8','0x2207cf1bf9d5575d4b594b0af03c3ff493adcc73e824915ea943e8c7465a3019','0xe198d4399f639d63b969f2b29c8e99b566b64e19b3954d28f1891d7718b5bb11','0xdc16b8e3ce083e65e59320996ee57f6c109c3133745572248d20172b0bb66869','0x96ef2ff909fb9f06c68e31df5e4e4eae3fc2608787e335b0c2de1ec8ab80d0e1','0x3d96f5fb210d810b87ce9e84f3b4379e3245723dd21aa58ef98b40993abd1d2c','0x684fc16990a76a7fad344f40c5c7bf980d081bf4790556707d9fd6661073765c','0x615d513615473e8b44461603bad950ce04ab832119bee74b4cf773d5ccf6725f','0x8f6f2be5e09bf6d126577cee0c61518e6609cd95ca8b63b3dc3907997ce51295','0x596e33b181cea262f18984fb05d162b2e18de692b5db66c9238e67a88b7b093c','0xcf31b75681f2120c15193a82f1aac3130e0461a499fd0e3dda8b3520aab5d2b6','0x7ca722d2ebc0c76078007357a9b6c52029327a51a228c4f706d70f4019d4dccd','0xc742ba3bd23a5e30ad7dd63709b2ee0144a7c49ac6dd39c8184cc45111e9f51f','0x636bd1452da23d746d565ef4f2ad57c667c293e294e2ad8d04258eb513d9b6e3','0xc897927da59e9bcf423cc40e018d6e81ebf250c2f50b64a39845e81811ee5606','0x5eefc5714aa913cccf8d34a8236080f3c4cfb3a0e3ea63a1cf8cb0886d1aa068','0x22a1164e7513f2785416d618cc7286db6342d0fa0757fe0e7bdfd6cd760fa0e1','0xfc725466be9b512609b014184829c2f8be0bbd32657d68ce1074e5702a55cc99','0x3dc7efe2ff2dd5e3f9541c0cb4709a5f26589db29bbf96a61de9dad3495286ec','0xd9d30cc63c95a0c5bda7e7009c7f7665e83431df930108171c1a4e441cbcbf62','0x8836fca7903ca786603ff0c0ab061b57b1cf5a9dd44cf8e2126dcbdf9615e321','0x04d2481cb86d444579c628b5e2a6f00a4577d0826938f5bcd6a3651bbaaf5149','0x7476c573a687b0b44acc018a7caa5fe33ab37c8c77d2103fa99cf5bdc45c13ab','0x88b164099103413c9ff6d6275ed1f9ed8f65659cb38f33ed880460fc87242589','0xd3be7722458f2194c8315477d1b59804f2fd266d810f83d4c869a83ca50e24f6','0x81349dda7a621c3852117b19c3caf6a3da6863bf1cbee4e16f1b6b74f6d3cd79','0x1b091327aed4a9b0e79064d4388e7fce6f5a19581f5a83b392082fb8004530a7','0x4e820c3d24be8e964ff31766b7f3e9c9791188952f2068aef6eaa4ed9a4ae2a2','0xf727cf9993bc7921666464a8016cc642fabc6bedd1055c22ac3e1228c57cabc5','0xfccd0cbd8c05d1250c6e64eeba569571f362edef12bc023c2be439a8e879e099','0xe5e7395de85633a2d0598c12af034765f57604bc78be4e3ecdb4055334923042','0x8fab7e955f7a4d81caac7f9fbc18151241b93879f57ba4ce2c8f1996a5d983a5','0x42941ede01750c6058f609fb14e0dad41bfb8ad3eb7c06aff6b1f94c3b728dac','0x43cb2ff3517662be99fd3addeaf4ba4c49e65cba62ecbbe01871f4580012bd0e','0xe949f23557104151bf855470eab95902870aed67e5ca693b4b02a1de37b34091','0x1b2896f8ae22a20d230b4175192602afa3331397c1a0edba6089dce932cee1cf','0x10b1472946e87f964bb569d8ddcb7b84ce734c48b17812f8309f370bdb849a98','0x0eb52ccf1b8678f0ebec48277caaedfa05ff9a706609857c215ad852246b040c','0x3548032f3fa8d5b3770d7a64fdb1544653e0a53a0266c9f58586acd2551e8347','0x1fb9fc5a28d927c7f9d9a784335c7b38d98c10de995bf95a661fc83f2a66742f','0x5fe92205efbb9f183c94ff4b63e9ba63d509fd7673146ede22a00ff822006b9a','0x17cf7505868df9d5a354f9cf27ac31adbdf17817078c8b902efc7741715b81aa','0x5c02ed6e66d1125eaf8e1bc89e3b552e765703694bd63a8c71ad57f835610c44','0x9dab46ea49d68770a2cd2c7f3e441da1cd0bd4a13c2b9425903aa90b2bafc5d2','0x276f0137f11c5da02f5c6bad5084adb84b23e3ffd473f7d277be5b2eda5f63fc','0x5c6d555dc907a73294f2908059b01023acac42375486028a2182b703a5599c53','0x5be319934a03671a9bad79d785196fa003cbe30ed743104d8bb304e84f37f108','0xb89bd57c242358bde28257f4ddf33d76aa1d80b352acc359f2503443a6b6953e','0x3c3e8c873a0f7bf0213f192b9c9155d5b9782da5c30f1a74e80159387ec6aaa3','0xc9021196ae752120a00f3734fc66a4740d32be9c3ca5839e5a142348bfcded38','0x0a30c26ead1534db1efd18d53deb2c72510278bc21cbc8146e59ade7a227745f','0xd2044d5ee37e21990048d2b49bc0db28a57eed609b554b01610fd16be6304d09','0x8718d88ec04ea64d62af71881d4ccdfa9df0962fdb74ebc37cdd5d0d3105e199','0x85cbeb1c674e68b1424d4821e2cdef241c13f894e750ce4cf0ac07363c5eb3bc','0xf44cfce4c7f0386245d74f98bb0fadc66bc8b022e8711c23928d0676d4b2f5d2','0xba1ff56dcc665d58f3506728952fd16dbcfe093bb6bbd03e050489da6db74daa','0x9d15fb18b873143fdbad6baab26c5f83bbb7a4559e47becf207228c9cec3b35a','0x01b9b3319f5d460fa1ccafec03476748bcf201ce85c3cdbd4cc314453f0ed53e','0xaef356a82f69f82a9a5ecbaaace5fb649dcc18bd42eea4f89f51a758e3c68e03','0xe5bcce6d4a32367ea553cd107682562f8eeb8af43db27ec09e93e67fd2392b2f','0xe039acacda71507da6bf887672914aeb4b2d232839662d2b3507a31faf75483d','0x0d1f32672cb7b82a09e8bfa4de0d74136f597506eae154fdfdb50b9a9f00bfc1','0x5660dbbbf9873e58f34dea97cb6cd11a9110cf3f07024d2be2d92261dc10f36c','0x7d9a9a0b7b79fb1d46efb73d9b7d6f70d75c0b17d89be499257b02ed6b13cc18','0x00cddeab688459e4a510ef3aecb0e7411db6e34f20b61249b0c0b6f53379e4e4','0x1240a9732b1986de4a5b270e824470f1834eb805c66d1b46183b8c2f61110d35','0x52417ef0beb127f14aafbb593ca44219e1066e19324edd490a1d3d9359174b7a','0xcbb475dca486e37f8796aa68ca2244008cc5687f5c89fb5351ea8b9c000e77d6','0x90c1963a531007ff87ac5b37f3e57ae0d9cc7c731c3ab444b16910e52bf60af5','0x937eafdb3cb8fdd733acdbc82a546f31be57307ca6fd484730da50a7cf8ea66b','0xdee27987472db49b9f3ef9254076911c7c54f5aa43aea4f75303bd7bdbafceff','0xbde1245e791259663594c933ea5154d93475fa6048ccf4b1d688fa3bd408702f','0xe4f4d45f571d1eeb009825ff7a5eec5cdcce32f64d443d81bdd9b2dd60976b77','0x6dc4d415b9f10f6988c8ca8d4cb452a83333ff57efdcfa1fe43aa4d1d96c9de5','0x3eeb856d64b405b2d61bb485fc9a892ffeb641cdc4b8a7d30ee6fae662572218','0xc3bb1089573d5e93add86aedca7c249c7e3868359aa252157a865e6cab10e15e','0x5f788fd9340751cfca2ab68161ff0181a58d80e15101d332bf46062647180f52','0x0387003b3bb9213c9a1fe6befc207ac483a5f22c56923bf3977baf0e78acc8f9','0x40f5c81ea2721044cc00a6dc03bb5bb7704381f4ecc3b2b15ea094b573a929d5','0x210c56f3711371ee794adb225c659a2723c4c288ef58816ef30200364aa3f4c0','0x63730f341756fbff0d4b26a4fb51b453e961f175a953b56e5ae67f2e460a1bb5','0x1f1bd3dfc1d8383f082337d6706e9ca8fd8622ba76a7e11e925ff378770f713f','0x6bd3be5e55432f099bf81610291a66b957b45460447bfacb2807897995ec331c','0x0f4184b38a387de6e3f45b9968e558ad214247113cf585ef438d4e234eb1165b','0xee71a8301f99c95899ecde84751cf8a85ffe5f563662af27e5e6d6245827c72c','0xd76d85a25e993e2f97325fbcc5f32b04657608a2faab62b0a43082bb1f9473ed','0xcf9bcaee08c1dca2abb2fce781a7c4bc6ad6893557e7c18341258546aacc0362','0x3a551933cd48ad91cf620f614dbe1cc46c3a58c9621fd96b35436aa7631dbe02','0xb9ede3add9c251e5f4fe7b496e02aa7b84c8b349ac05ffb7955428fd234fd0f3','0xac6d01615ed295f6fda0b1faa0a84a6329fc20e6bc190c4d27a7023aa2941e4b','0xc9ef39364576abe9b2d797911b533c9d4814b20eae26668bd1a1fd84499b4f46','0xca04d4c76661492083c78e107340653a914e22fe9c709393a982b4740610b464','0x055761ed2f3953bfb919622a330df881412149828c12834383a3d1181ad09747','0x402e4826eca2bd1dc536079746ee9660c6f75f5e643e3fd9274e10767fdef085','0xc3d7845407728550cefcf2c753089d764fdfaaefb4b24f81e89232e294a749dc','0x2d7d613eb4228609f2b1ee9f4a54873243d07dd9f28ff000d3632571f1aa102d','0xdc0473e95755ee2a48cc97bbb1a506f7be21bd1086e3700352436a880dc4d367','0xbf9302e59043b7d40670ae7d655a3b5908b39bd3d8f79d3b4963a792ce53a7ee','0x23a758508c5c2feb481608c7184ad0d445f80e7b07c5bd5ed5d99f5f0bb7c005','0x2319b77fbd2dcb42a6160e5ee0a3b034291c0f672ed7b17530ed4b333a24b506','0xca9cfca371e5ccd457af0f1035263336cf228a7bfbb354e99b856d2bcd60e276','0x3464c22721d0d899eed3e6cf4c19a56416a4c8cbb07f6d158480e348b3382b6e','0x01f19621d6348dc1f50f0027cd636e6017af568c00ac7de6221465e5883bbf45','0xf86e6f2aa6e172177c7f7837a76abbd70a36eb6383495d47c7dc21b2ddf6f28a','0x27a38aa310d25de41f2ca1fb93ee28553c8b85376fbda6c1eb4372ce1d23150d','0x850118a5b4b71fba2a24189ee3ac751d3fb81b02c0ac4fd9ab260dc290e8bbf1','0x8b32715d406ada1c084aeac7170b3ae5aa663789efe42d6732212cba2e4eca3b','0x62fda65f623d5c707c1b0db3693fd5c756566e06456ba7b55e54b096c06ba3c6','0x33363463ead428654d00df7694dbf7639468d569fbc1eff0c8c02ee92237fadc','0xdfd33074ea2e88daaa78c01e9f4b5c1a8c171f85e161752ce70c092a99c6dcb2','0x45ef5bbdcc0655b20037e864fdadb349176b43b32bf418c8b9e18025a3e3fc20','0x7f1f136a279b31fe85697b378c287dedeb07a5ea0ca0e1cc81550ead041acc0d','0x6f46fdbfab3e1dbad695836c49f6b489378636df20985e724cb0e1c28ffe7aac','0x2d66bac30487ff5c96b70c60c422f518c2768276d0ee67ff624e26e90f372df6','0x9633e80e21cd3aee56af7e4bcc16ef98d086aa0b8d2285951b716fd2b9b80344','0x51149e0306f97174628bc6dc084ff1dc17f46c587615ed1ad205537a8daeed60','0x387d85da7e7bb47a23e7b49d3b4aacd86e046e93512293e0241464060fb1b8d0','0x89e15ca21017ead7daa451592100d23fba4d863b684f45348435a66b66b13fd2','0x432084a49e85701e9a53a3e1520eedafc95739236b0839fd5030d56bf5860805','0xc8c0c34d46d87590ef7a294c7f9bc2c9796f25132bb1bc4c232d247f6b377df4','0x3052953921cae54127218307b3d83d65193060c0946ba2cff7f51637ba5a4289','0x22cc6f00b0589ece3a468d1a8b98ad6ccdf0a7ddeb42e9f63b67b4be91a99af5','0x64e97b5d9cfd628fd1f47d6744be7ed3428e25dc3bd9efbba3bc9eeb62d8c427','0x1d5e7e4fbbf67251f5d30bbd25cb6298b105a7ac1e60f43c6ce8966b3776f64c','0x350eb14829c4e167bc29800c9bd73834d761de052010c763310359b1551b0c52','0x686b67e0d060b66d9b7a2351aa752b674dfb360f7dec69a7775bb837eeb1c5c5','0x5d5764040d6ad537a05d5d2d70a251df6b5196981374a6ef9ba336edb2dfd0f0','0x793a6e1f03195353e031afe79d86fafa4583a5aa8f5d9871599306ebdcc8125e','0xfd744faf1f0b707ff26ac9f6818b0ed6e7088e1c237355bcc348339044bb072a','0xd473154f48ee2ffe324320fcadea0909459320837125201e3438c0b1f8fd0387','0x077fd2822bce19735321aa9ba9ca27204aa3e83c7c36639cc2dc6fa99405c666','0x145dc73dd7df0cc03dad29711bfcea41e6c7c193707faa761f29de9de76501ba','0x49d6b0ca48a4d9ac74e50351cb16f65c7b4a6098591840e8ded5cf4d362154aa','0x4f43a57584b4d21d5cd2ffef23ae14997454b2ebf1a6fa143489bc1f0e2ca2e6','0x14953b6c3891128bb9faa8a0c8e51f2e625a5fd170356e5bb497c8f861085f83','0xec045bbb288f1260ec76ab47b87b15231f6101642a0ff155a2f3be63eca75e69','0x2c19a30a66d2572d420c281f38a94daf2ae33d53e91c70fdaaf0b0d2fefbe049','0xeb31ebe2ab71d8208fa0a4cbecfe6c80ca0344af857b4d5212d09a884b84add1','0x06d258875890f16a7f84f83adf763c486a6ab345947da242f0c26a6fc4f67f9a','0x58352e75d26a3fa5c5c682b669ada25eeed96254fcc95794b7fa4d98e7931486','0x3d1f849af1660a5e030bc781e0f4249dc666c36d4f3d83f489570fe09085094a','0xf34062c3ff6a01d78b13c34e8dc5e95ebdfe5dd10bd0cc8fc756ec2c8b2e1735','0x0b79909fd8e97817c22c85b4a78870b1635095505b9b52cbc872af09dbda50d7','0x69ef4aa4dfacf3e630913a7166638bc03afa8cf1a59f6bc78f70b893edd44291','0x09c707744d0c5d06f40d35fda43b50f52d2970aa52a4b6b7262279bee5730a9f','0xebbafdf146915917507ed35b9375d904bd13e5da7bf82df846b3f799d709ee6d','0x09694be6ee6525cf3ac6598810106755004f105c5e089f359bd89886def023dc','0xe6da49948664540bd98bc5ef3b1b9b742434d28453b5dbee8c9aa5aadca63bf4','0x223f5323abfb90dcaa680da763f349bb15e7398ba983e8627e4a8295f49c20a8','0x38d6b896a82422f472aebc91f853e70a4f3404a40873713b5a11bfd8d9daf1fb','0x3dbb574d078d88b0d7356662f47f1a9d1716f83f048d4dc8d91745b1b1cc3564']

// server 4
// const ethereumNodeUrl = 'http://3.36.183.216:8704';

// 웹3 인스턴스 생성
const web3Meta = new Web3(new Web3.providers.HttpProvider(ethereumNodeUrl));
const ContractAddress = '0xB07C758b16c43C01D4e182FAd97D8E8Ad85e0EA1';
const ContractABI =[ { "inputs": [], "name": "amount", "outputs": [ { "internalType": "uint256", "name": "", "type": "uint256" } ], "stateMutability": "view", "type": "function", "constant": true }, { "inputs": [], "name": "recipient", "outputs": [ { "internalType": "address", "name": "", "type": "address" } ], "stateMutability": "view", "type": "function", "constant": true }, { "inputs": [], "name": "tokenAddress", "outputs": [ { "internalType": "address", "name": "", "type": "address" } ], "stateMutability": "view", "type": "function", "constant": true }, { "inputs": [], "name": "transferTokens", "outputs": [], "stateMutability": "nonpayable", "type": "function" } ];

// // 이더리움 계정의 nonce 가져오기
// async function getNonce(address) {
//   return await web3Meta.eth.getTransactionCount(address, 'latest');
// }

// 서명된 트랜잭션 생성 및 전송
async function sendSignedTransaction(rawTx) {
  return await web3Meta.eth.sendSignedTransaction(rawTx);
}

let contract = new web3Meta.eth.Contract(ContractABI, ContractAddress);

// transferTokens 함수 호출 데이터 생성
const data = contract.methods.transferTokens().encodeABI();

cnt = 0
router.get("/transToken", async function (req, res, next) {
  try {
    cnt = cnt % 250
    // account 불러오기
    const account = web3Meta.eth.accounts.privateKeyToAccount(privateKey[cnt]);
    cnt++;
    // 0.5초 대기
    // await new Promise(resolve => setTimeout(resolve, 500));

    let nonce = await web3Meta.eth.getTransactionCount(account.address, 'pending');
    // let nonce = await web3Meta.eth.getTransactionCount(account.address, 'latest');


    // 트랜잭션 생성
    const tx = {
      nonce: nonce,
      to: ContractAddress,
      gasPrice: '0x0',
      gasLimit: web3Meta.utils.toHex(210000),
      value: '0x0',
      data: data
    };

    // 트랜잭션 서명
    const signedTx = await account.signTransaction(tx);

    // 서명된 트랜잭션 전송
    const txHash = await sendSignedTransaction(signedTx.rawTransaction);

    res.send(txHash);

  } catch (error) {
    console.error(error);
    res.send(error);
    // res.status(500).json({ error: 'Something went wrong' });
  }
});

router.get("/getBalance", async function (req, res, next) {

  res.send(contract.methods.GetBalance().call());

});

router.get("/getTotalSup", async function (req, res, next) {

  res.send(contract.methods.GetTotalSup().call());

});

router.get("/hello", async function (req, res, next) {
  res.send("hello")
});

module.exports = router;